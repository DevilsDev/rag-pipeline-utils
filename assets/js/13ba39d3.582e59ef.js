"use strict";(self.webpackChunk_devilsdev_rag_pipeline_utils_docs=self.webpackChunk_devilsdev_rag_pipeline_utils_docs||[]).push([[4747],{1575:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"Security","title":"Security Guide","description":"This comprehensive security guide covers best practices, threat mitigation, and security configurations for @DevilsDev/rag-pipeline-utils. From API key management to data privacy and plugin security, this guide ensures your RAG pipeline deployments are secure and compliant.","source":"@site/docs/Security.md","sourceDirName":".","slug":"/Security","permalink":"/rag-pipeline-utils/docs/Security","draft":false,"unlisted":false,"editUrl":"https://github.com/DevilsDev/rag-pipeline-utils/edit/develop/docs-site/docs/Security.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Observability & Monitoring","permalink":"/rag-pipeline-utils/docs/Observability"},"next":{"title":"Evaluation Framework","permalink":"/rag-pipeline-utils/docs/Evaluation"}}');var i=r(4848),s=r(8453);const o={},a="Security Guide",c={},l=[{value:"\ud83d\udd10 <strong>Security Overview</strong>",id:"-security-overview",level:2},{value:"<strong>Security Principles</strong>",id:"security-principles",level:3},{value:"<strong>Threat Model</strong>",id:"threat-model",level:3},{value:"\ud83d\udd11 <strong>Authentication &amp; Authorization</strong>",id:"-authentication--authorization",level:2},{value:"<strong>API Key Management</strong>",id:"api-key-management",level:3},{value:"<strong>Access Control</strong>",id:"access-control",level:3},{value:"\ud83d\udee1\ufe0f <strong>Data Protection</strong>",id:"\ufe0f-data-protection",level:2},{value:"<strong>Encryption</strong>",id:"encryption",level:3},{value:"<strong>Data Sanitization</strong>",id:"data-sanitization",level:3},{value:"\ud83d\udd12 <strong>Plugin Security</strong>",id:"-plugin-security",level:2},{value:"<strong>Plugin Sandboxing</strong>",id:"plugin-sandboxing",level:3},{value:"<strong>Plugin Verification</strong>",id:"plugin-verification",level:3},{value:"\ud83d\udd0d <strong>Monitoring &amp; Auditing</strong>",id:"-monitoring--auditing",level:2},{value:"<strong>Security Logging</strong>",id:"security-logging",level:3},{value:"<strong>Anomaly Detection</strong>",id:"anomaly-detection",level:3},{value:"\ud83d\udee0\ufe0f <strong>Security Configuration</strong>",id:"\ufe0f-security-configuration",level:2},{value:"<strong>Secure Defaults</strong>",id:"secure-defaults",level:3},{value:"<strong>Environment-Specific Security</strong>",id:"environment-specific-security",level:3},{value:"\ud83d\udea8 <strong>Incident Response</strong>",id:"-incident-response",level:2},{value:"<strong>Security Incident Handling</strong>",id:"security-incident-handling",level:3},{value:"\u2705 <strong>Security Checklist</strong>",id:"-security-checklist",level:2},{value:"<strong>Deployment Security</strong>",id:"deployment-security",level:3},{value:"<strong>Operational Security</strong>",id:"operational-security",level:3},{value:"\ud83d\udcde <strong>Security Support</strong>",id:"-security-support",level:2},{value:"<strong>Reporting Security Issues</strong>",id:"reporting-security-issues",level:3},{value:"<strong>Security Resources</strong>",id:"security-resources",level:3}];function u(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"security-guide",children:"Security Guide"})}),"\n",(0,i.jsxs)(n.p,{children:["This comprehensive security guide covers best practices, threat mitigation, and security configurations for ",(0,i.jsx)(n.strong,{children:"@DevilsDev/rag-pipeline-utils"}),". From API key management to data privacy and plugin security, this guide ensures your RAG pipeline deployments are secure and compliant."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"-security-overview",children:["\ud83d\udd10 ",(0,i.jsx)(n.strong,{children:"Security Overview"})]}),"\n",(0,i.jsx)(n.h3,{id:"security-principles",children:(0,i.jsx)(n.strong,{children:"Security Principles"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Defense in Depth"}),": Multiple layers of security controls"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Least Privilege"}),": Minimal access rights for components"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Zero Trust"}),": Verify everything, trust nothing"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Data Privacy"}),": Protect sensitive information throughout the pipeline"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Secure by Default"}),": Security-first configuration defaults"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"threat-model",children:(0,i.jsx)(n.strong,{children:"Threat Model"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Common Threats"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"API key exposure and misuse"}),"\n",(0,i.jsx)(n.li,{children:"Prompt injection attacks"}),"\n",(0,i.jsx)(n.li,{children:"Data exfiltration through embeddings"}),"\n",(0,i.jsx)(n.li,{children:"Malicious plugin execution"}),"\n",(0,i.jsx)(n.li,{children:"Man-in-the-middle attacks"}),"\n",(0,i.jsx)(n.li,{children:"Unauthorized access to vector stores"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"-authentication--authorization",children:["\ud83d\udd11 ",(0,i.jsx)(n.strong,{children:"Authentication & Authorization"})]}),"\n",(0,i.jsx)(n.h3,{id:"api-key-management",children:(0,i.jsx)(n.strong,{children:"API Key Management"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Secure Storage"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Use environment variables (recommended)\r\nexport OPENAI_API_KEY="sk-your-secure-key-here"\r\nexport PINECONE_API_KEY="your-pinecone-key"\r\n\r\n# Use secure key management services\r\nexport OPENAI_API_KEY=$(aws secretsmanager get-secret-value --secret-id openai-key --query SecretString --output text)\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Configuration Security"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n  "plugins": {\r\n    "embedder": {\r\n      "name": "openai",\r\n      "config": {\r\n        "apiKey": "${OPENAI_API_KEY}",  // Environment variable reference\r\n        "organization": "${OPENAI_ORG_ID}",\r\n        "timeout": 30000,\r\n        "retryAttempts": 3\r\n      }\r\n    }\r\n  },\r\n  "security": {\r\n    "encryptConfig": true,\r\n    "configEncryptionKey": "${CONFIG_ENCRYPTION_KEY}",\r\n    "auditLogging": true\r\n  }\r\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Key Rotation Strategy"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Implement automatic key rotation\r\nclass SecureKeyManager {\r\n  constructor(options = {}) {\r\n    this.keyRotationInterval = options.rotationInterval || 86400000; // 24 hours\r\n    this.keyStore = options.keyStore; // AWS Secrets Manager, HashiCorp Vault, etc.\r\n    this.currentKeys = new Map();\r\n  }\r\n\r\n  async rotateKeys() {\r\n    const services = ['openai', 'pinecone', 'cohere'];\r\n    \r\n    for (const service of services) {\r\n      try {\r\n        const newKey = await this.generateNewKey(service);\r\n        await this.updateServiceKey(service, newKey);\r\n        await this.keyStore.storeKey(service, newKey);\r\n        \r\n        // Keep old key for graceful transition\r\n        setTimeout(() => this.revokeOldKey(service), 300000); // 5 minutes\r\n        \r\n        console.log(`Successfully rotated key for ${service}`);\r\n      } catch (error) {\r\n        console.error(`Failed to rotate key for ${service}:`, error);\r\n      }\r\n    }\r\n  }\r\n\r\n  async getSecureKey(service) {\r\n    // Check if key needs rotation\r\n    const keyAge = Date.now() - this.currentKeys.get(service)?.timestamp;\r\n    if (keyAge > this.keyRotationInterval) {\r\n      await this.rotateKeys();\r\n    }\r\n    \r\n    return this.keyStore.getKey(service);\r\n  }\r\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"access-control",children:(0,i.jsx)(n.strong,{children:"Access Control"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Role-Based Access Control (RBAC)"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Define user roles and permissions\r\nconst roles = {\r\n  'admin': {\r\n    permissions: ['read', 'write', 'delete', 'configure', 'manage-users'],\r\n    resources: ['*']\r\n  },\r\n  'developer': {\r\n    permissions: ['read', 'write', 'configure'],\r\n    resources: ['pipelines', 'plugins', 'evaluations']\r\n  },\r\n  'analyst': {\r\n    permissions: ['read', 'query'],\r\n    resources: ['pipelines', 'evaluations']\r\n  },\r\n  'viewer': {\r\n    permissions: ['read'],\r\n    resources: ['evaluations']\r\n  }\r\n};\r\n\r\n// Implement access control middleware\r\nclass AccessControl {\r\n  constructor(roles) {\r\n    this.roles = roles;\r\n  }\r\n\r\n  authorize(user, action, resource) {\r\n    const userRole = this.roles[user.role];\r\n    if (!userRole) return false;\r\n\r\n    const hasPermission = userRole.permissions.includes(action);\r\n    const hasResourceAccess = userRole.resources.includes('*') || \r\n                             userRole.resources.includes(resource);\r\n\r\n    return hasPermission && hasResourceAccess;\r\n  }\r\n\r\n  middleware() {\r\n    return (req, res, next) => {\r\n      const { user, action, resource } = req;\r\n      \r\n      if (!this.authorize(user, action, resource)) {\r\n        return res.status(403).json({ error: 'Access denied' });\r\n      }\r\n      \r\n      next();\r\n    };\r\n  }\r\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"API Authentication"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Implement JWT-based authentication\r\nimport jwt from 'jsonwebtoken';\r\n\r\nclass AuthenticationManager {\r\n  constructor(options = {}) {\r\n    this.jwtSecret = options.jwtSecret || process.env.JWT_SECRET;\r\n    this.tokenExpiry = options.tokenExpiry || '1h';\r\n    this.refreshTokenExpiry = options.refreshTokenExpiry || '7d';\r\n  }\r\n\r\n  generateTokens(user) {\r\n    const accessToken = jwt.sign(\r\n      { \r\n        userId: user.id, \r\n        role: user.role,\r\n        permissions: user.permissions \r\n      },\r\n      this.jwtSecret,\r\n      { expiresIn: this.tokenExpiry }\r\n    );\r\n\r\n    const refreshToken = jwt.sign(\r\n      { userId: user.id, type: 'refresh' },\r\n      this.jwtSecret,\r\n      { expiresIn: this.refreshTokenExpiry }\r\n    );\r\n\r\n    return { accessToken, refreshToken };\r\n  }\r\n\r\n  verifyToken(token) {\r\n    try {\r\n      return jwt.verify(token, this.jwtSecret);\r\n    } catch (error) {\r\n      throw new Error('Invalid or expired token');\r\n    }\r\n  }\r\n\r\n  middleware() {\r\n    return (req, res, next) => {\r\n      const authHeader = req.headers.authorization;\r\n      if (!authHeader || !authHeader.startsWith('Bearer ')) {\r\n        return res.status(401).json({ error: 'Missing or invalid authorization header' });\r\n      }\r\n\r\n      const token = authHeader.substring(7);\r\n      try {\r\n        const decoded = this.verifyToken(token);\r\n        req.user = decoded;\r\n        next();\r\n      } catch (error) {\r\n        return res.status(401).json({ error: 'Invalid token' });\r\n      }\r\n    };\r\n  }\r\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"\ufe0f-data-protection",children:["\ud83d\udee1\ufe0f ",(0,i.jsx)(n.strong,{children:"Data Protection"})]}),"\n",(0,i.jsx)(n.h3,{id:"encryption",children:(0,i.jsx)(n.strong,{children:"Encryption"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Data at Rest"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Encrypt sensitive data before storage\r\nimport crypto from 'crypto';\r\n\r\nclass DataEncryption {\r\n  constructor(encryptionKey) {\r\n    this.algorithm = 'aes-256-gcm';\r\n    this.key = crypto.scryptSync(encryptionKey, 'salt', 32);\r\n  }\r\n\r\n  encrypt(data) {\r\n    const iv = crypto.randomBytes(16);\r\n    const cipher = crypto.createCipher(this.algorithm, this.key, iv);\r\n    \r\n    let encrypted = cipher.update(JSON.stringify(data), 'utf8', 'hex');\r\n    encrypted += cipher.final('hex');\r\n    \r\n    const authTag = cipher.getAuthTag();\r\n    \r\n    return {\r\n      encrypted,\r\n      iv: iv.toString('hex'),\r\n      authTag: authTag.toString('hex')\r\n    };\r\n  }\r\n\r\n  decrypt(encryptedData) {\r\n    const decipher = crypto.createDecipher(\r\n      this.algorithm, \r\n      this.key, \r\n      Buffer.from(encryptedData.iv, 'hex')\r\n    );\r\n    \r\n    decipher.setAuthTag(Buffer.from(encryptedData.authTag, 'hex'));\r\n    \r\n    let decrypted = decipher.update(encryptedData.encrypted, 'hex', 'utf8');\r\n    decrypted += decipher.final('utf8');\r\n    \r\n    return JSON.parse(decrypted);\r\n  }\r\n}\r\n\r\n// Use encryption for sensitive configurations\r\nconst encryption = new DataEncryption(process.env.ENCRYPTION_KEY);\r\nconst encryptedConfig = encryption.encrypt(sensitiveConfig);\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Data in Transit"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Enforce HTTPS and TLS\r\nconst pipeline = createRagPipeline({\r\n  security: {\r\n    enforceHTTPS: true,\r\n    tlsVersion: '1.3',\r\n    certificateValidation: true,\r\n    \r\n    // API client security\r\n    apiClients: {\r\n      openai: {\r\n        timeout: 30000,\r\n        validateCertificate: true,\r\n        rejectUnauthorized: true\r\n      },\r\n      pinecone: {\r\n        timeout: 10000,\r\n        validateCertificate: true,\r\n        customCA: process.env.PINECONE_CA_CERT\r\n      }\r\n    }\r\n  }\r\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"data-sanitization",children:(0,i.jsx)(n.strong,{children:"Data Sanitization"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Input Sanitization"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Sanitize user inputs to prevent injection attacks\r\nclass InputSanitizer {\r\n  constructor() {\r\n    this.maxQueryLength = 1000;\r\n    this.allowedCharacters = /^[a-zA-Z0-9\\s\\-_.,!?'\"()]+$/;\r\n    this.blockedPatterns = [\r\n      /system\\s*:/i,\r\n      /assistant\\s*:/i,\r\n      /ignore\\s+previous/i,\r\n      /forget\\s+everything/i,\r\n      /<script/i,\r\n      /javascript:/i\r\n    ];\r\n  }\r\n\r\n  sanitizeQuery(query) {\r\n    // Length validation\r\n    if (query.length > this.maxQueryLength) {\r\n      throw new Error('Query exceeds maximum length');\r\n    }\r\n\r\n    // Character validation\r\n    if (!this.allowedCharacters.test(query)) {\r\n      throw new Error('Query contains invalid characters');\r\n    }\r\n\r\n    // Pattern blocking\r\n    for (const pattern of this.blockedPatterns) {\r\n      if (pattern.test(query)) {\r\n        throw new Error('Query contains blocked patterns');\r\n      }\r\n    }\r\n\r\n    // HTML encoding\r\n    return query\r\n      .replace(/&/g, '&amp;')\r\n      .replace(/</g, '&lt;')\r\n      .replace(/>/g, '&gt;')\r\n      .replace(/\"/g, '&quot;')\r\n      .replace(/'/g, '&#x27;');\r\n  }\r\n\r\n  sanitizeMetadata(metadata) {\r\n    const sanitized = {};\r\n    \r\n    for (const [key, value] of Object.entries(metadata)) {\r\n      // Validate key\r\n      if (!/^[a-zA-Z0-9_]+$/.test(key)) {\r\n        continue; // Skip invalid keys\r\n      }\r\n      \r\n      // Sanitize value\r\n      if (typeof value === 'string') {\r\n        sanitized[key] = this.sanitizeQuery(value);\r\n      } else if (typeof value === 'number') {\r\n        sanitized[key] = value;\r\n      } else if (typeof value === 'boolean') {\r\n        sanitized[key] = value;\r\n      }\r\n      // Skip other types\r\n    }\r\n    \r\n    return sanitized;\r\n  }\r\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Output Filtering"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Filter sensitive information from outputs\r\nclass OutputFilter {\r\n  constructor() {\r\n    this.sensitivePatterns = [\r\n      /\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b/g, // Email\r\n      /\\b\\d{3}-\\d{2}-\\d{4}\\b/g, // SSN\r\n      /\\b\\d{4}[\\s-]?\\d{4}[\\s-]?\\d{4}[\\s-]?\\d{4}\\b/g, // Credit card\r\n      /\\bsk-[a-zA-Z0-9]{48}\\b/g, // OpenAI API key\r\n      /\\b[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\\b/g // UUID\r\n    ];\r\n  }\r\n\r\n  filterSensitiveData(text) {\r\n    let filtered = text;\r\n    \r\n    for (const pattern of this.sensitivePatterns) {\r\n      filtered = filtered.replace(pattern, '[REDACTED]');\r\n    }\r\n    \r\n    return filtered;\r\n  }\r\n\r\n  filterResponse(response) {\r\n    return {\r\n      ...response,\r\n      content: this.filterSensitiveData(response.content),\r\n      sources: response.sources?.map(source => ({\r\n        ...source,\r\n        content: this.filterSensitiveData(source.content)\r\n      }))\r\n    };\r\n  }\r\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"-plugin-security",children:["\ud83d\udd12 ",(0,i.jsx)(n.strong,{children:"Plugin Security"})]}),"\n",(0,i.jsx)(n.h3,{id:"plugin-sandboxing",children:(0,i.jsx)(n.strong,{children:"Plugin Sandboxing"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Implement secure plugin execution\r\nimport { VM } from 'vm2';\r\n\r\nclass SecurePluginRunner {\r\n  constructor(options = {}) {\r\n    this.timeout = options.timeout || 30000;\r\n    this.memoryLimit = options.memoryLimit || 128 * 1024 * 1024; // 128MB\r\n    this.allowedModules = options.allowedModules || ['fs', 'path', 'crypto'];\r\n  }\r\n\r\n  async executePlugin(pluginCode, context = {}) {\r\n    const vm = new VM({\r\n      timeout: this.timeout,\r\n      sandbox: {\r\n        ...context,\r\n        console: {\r\n          log: (...args) => console.log('[Plugin]', ...args),\r\n          error: (...args) => console.error('[Plugin]', ...args)\r\n        },\r\n        require: (module) => {\r\n          if (!this.allowedModules.includes(module)) {\r\n            throw new Error(`Module '${module}' is not allowed`);\r\n          }\r\n          return require(module);\r\n        }\r\n      },\r\n      wasm: false,\r\n      fixAsync: true\r\n    });\r\n\r\n    try {\r\n      return await vm.run(pluginCode);\r\n    } catch (error) {\r\n      throw new Error(`Plugin execution failed: ${error.message}`);\r\n    }\r\n  }\r\n\r\n  validatePlugin(plugin) {\r\n    const validationRules = [\r\n      {\r\n        name: 'No eval usage',\r\n        test: (code) => !code.includes('eval(')\r\n      },\r\n      {\r\n        name: 'No Function constructor',\r\n        test: (code) => !code.includes('new Function(')\r\n      },\r\n      {\r\n        name: 'No process access',\r\n        test: (code) => !code.includes('process.')\r\n      },\r\n      {\r\n        name: 'No global access',\r\n        test: (code) => !code.includes('global.')\r\n      }\r\n    ];\r\n\r\n    const violations = validationRules.filter(rule => !rule.test(plugin.toString()));\r\n    \r\n    if (violations.length > 0) {\r\n      throw new Error(`Plugin validation failed: ${violations.map(v => v.name).join(', ')}`);\r\n    }\r\n  }\r\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"plugin-verification",children:(0,i.jsx)(n.strong,{children:"Plugin Verification"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Verify plugin integrity and authenticity\r\nimport crypto from 'crypto';\r\n\r\nclass PluginVerifier {\r\n  constructor(trustedPublishers = []) {\r\n    this.trustedPublishers = trustedPublishers;\r\n    this.signatureAlgorithm = 'sha256';\r\n  }\r\n\r\n  verifySignature(plugin, signature, publicKey) {\r\n    const verify = crypto.createVerify(this.signatureAlgorithm);\r\n    verify.update(plugin);\r\n    verify.end();\r\n    \r\n    return verify.verify(publicKey, signature, 'hex');\r\n  }\r\n\r\n  async verifyPlugin(pluginPath) {\r\n    const plugin = await fs.readFile(pluginPath, 'utf8');\r\n    const metadata = await this.extractMetadata(plugin);\r\n    \r\n    // Check if publisher is trusted\r\n    if (!this.trustedPublishers.includes(metadata.publisher)) {\r\n      throw new Error(`Untrusted publisher: ${metadata.publisher}`);\r\n    }\r\n    \r\n    // Verify digital signature\r\n    const signature = metadata.signature;\r\n    const publicKey = await this.getPublisherPublicKey(metadata.publisher);\r\n    \r\n    if (!this.verifySignature(plugin, signature, publicKey)) {\r\n      throw new Error('Plugin signature verification failed');\r\n    }\r\n    \r\n    // Check for known vulnerabilities\r\n    await this.scanForVulnerabilities(plugin);\r\n    \r\n    return { verified: true, metadata };\r\n  }\r\n\r\n  async scanForVulnerabilities(plugin) {\r\n    const vulnerabilityPatterns = [\r\n      /require\\(['\"]child_process['\"]\\)/,\r\n      /require\\(['\"]fs['\"]\\).*unlinkSync/,\r\n      /require\\(['\"]net['\"]\\).*createServer/,\r\n      /Buffer\\.from\\(.*base64.*\\)/\r\n    ];\r\n\r\n    for (const pattern of vulnerabilityPatterns) {\r\n      if (pattern.test(plugin)) {\r\n        throw new Error(`Potential security vulnerability detected: ${pattern}`);\r\n      }\r\n    }\r\n  }\r\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"-monitoring--auditing",children:["\ud83d\udd0d ",(0,i.jsx)(n.strong,{children:"Monitoring & Auditing"})]}),"\n",(0,i.jsx)(n.h3,{id:"security-logging",children:(0,i.jsx)(n.strong,{children:"Security Logging"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Implement comprehensive security logging\r\nclass SecurityLogger {\r\n  constructor(options = {}) {\r\n    this.logLevel = options.logLevel || 'info';\r\n    this.logFile = options.logFile || './security.log';\r\n    this.enableAuditTrail = options.enableAuditTrail || true;\r\n  }\r\n\r\n  logSecurityEvent(event, details = {}) {\r\n    const logEntry = {\r\n      timestamp: new Date().toISOString(),\r\n      event,\r\n      details,\r\n      severity: this.getSeverity(event),\r\n      source: 'rag-pipeline-utils',\r\n      version: process.env.npm_package_version\r\n    };\r\n\r\n    // Log to file\r\n    fs.appendFileSync(this.logFile, JSON.stringify(logEntry) + '\\n');\r\n\r\n    // Send to SIEM if configured\r\n    if (process.env.SIEM_ENDPOINT) {\r\n      this.sendToSIEM(logEntry);\r\n    }\r\n\r\n    // Alert on high severity events\r\n    if (logEntry.severity === 'high' || logEntry.severity === 'critical') {\r\n      this.sendAlert(logEntry);\r\n    }\r\n  }\r\n\r\n  getSeverity(event) {\r\n    const severityMap = {\r\n      'authentication_failure': 'medium',\r\n      'authorization_failure': 'medium',\r\n      'plugin_execution_failure': 'high',\r\n      'api_key_rotation': 'low',\r\n      'suspicious_query': 'medium',\r\n      'data_access_violation': 'high',\r\n      'configuration_change': 'medium'\r\n    };\r\n\r\n    return severityMap[event] || 'low';\r\n  }\r\n\r\n  auditApiCall(req, res, next) {\r\n    const startTime = Date.now();\r\n    \r\n    res.on('finish', () => {\r\n      const duration = Date.now() - startTime;\r\n      \r\n      this.logSecurityEvent('api_call', {\r\n        method: req.method,\r\n        path: req.path,\r\n        statusCode: res.statusCode,\r\n        duration,\r\n        userAgent: req.get('User-Agent'),\r\n        ip: req.ip,\r\n        user: req.user?.id\r\n      });\r\n    });\r\n    \r\n    next();\r\n  }\r\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"anomaly-detection",children:(0,i.jsx)(n.strong,{children:"Anomaly Detection"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Detect suspicious activities\r\nclass AnomalyDetector {\r\n  constructor(options = {}) {\r\n    this.baselineWindow = options.baselineWindow || 3600000; // 1 hour\r\n    this.anomalyThreshold = options.anomalyThreshold || 2.5; // Standard deviations\r\n    this.metrics = new Map();\r\n  }\r\n\r\n  recordMetric(name, value) {\r\n    if (!this.metrics.has(name)) {\r\n      this.metrics.set(name, []);\r\n    }\r\n    \r\n    const values = this.metrics.get(name);\r\n    values.push({ value, timestamp: Date.now() });\r\n    \r\n    // Keep only recent values\r\n    const cutoff = Date.now() - this.baselineWindow;\r\n    this.metrics.set(name, values.filter(v => v.timestamp > cutoff));\r\n  }\r\n\r\n  detectAnomaly(name, currentValue) {\r\n    const values = this.metrics.get(name);\r\n    if (!values || values.length < 10) return false; // Need baseline\r\n    \r\n    const nums = values.map(v => v.value);\r\n    const mean = nums.reduce((a, b) => a + b, 0) / nums.length;\r\n    const variance = nums.reduce((a, b) => a + Math.pow(b - mean, 2), 0) / nums.length;\r\n    const stdDev = Math.sqrt(variance);\r\n    \r\n    const zScore = Math.abs(currentValue - mean) / stdDev;\r\n    \r\n    if (zScore > this.anomalyThreshold) {\r\n      this.alertAnomaly(name, currentValue, mean, zScore);\r\n      return true;\r\n    }\r\n    \r\n    return false;\r\n  }\r\n\r\n  alertAnomaly(metric, value, baseline, zScore) {\r\n    console.warn(`Anomaly detected in ${metric}: ${value} (baseline: ${baseline}, z-score: ${zScore})`);\r\n    \r\n    // Send alert to monitoring system\r\n    if (process.env.ALERT_WEBHOOK) {\r\n      fetch(process.env.ALERT_WEBHOOK, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          alert: 'anomaly_detected',\r\n          metric,\r\n          value,\r\n          baseline,\r\n          zScore,\r\n          timestamp: new Date().toISOString()\r\n        })\r\n      });\r\n    }\r\n  }\r\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"\ufe0f-security-configuration",children:["\ud83d\udee0\ufe0f ",(0,i.jsx)(n.strong,{children:"Security Configuration"})]}),"\n",(0,i.jsx)(n.h3,{id:"secure-defaults",children:(0,i.jsx)(n.strong,{children:"Secure Defaults"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n  "security": {\r\n    "authentication": {\r\n      "required": true,\r\n      "method": "jwt",\r\n      "tokenExpiry": "1h",\r\n      "refreshTokenExpiry": "7d"\r\n    },\r\n    "authorization": {\r\n      "rbac": true,\r\n      "defaultRole": "viewer",\r\n      "requireExplicitPermissions": true\r\n    },\r\n    "encryption": {\r\n      "dataAtRest": true,\r\n      "dataInTransit": true,\r\n      "algorithm": "aes-256-gcm",\r\n      "keyRotationInterval": "30d"\r\n    },\r\n    "plugins": {\r\n      "sandboxing": true,\r\n      "signatureVerification": true,\r\n      "trustedPublishersOnly": true,\r\n      "maxExecutionTime": 30000,\r\n      "memoryLimit": "128MB"\r\n    },\r\n    "logging": {\r\n      "auditTrail": true,\r\n      "securityEvents": true,\r\n      "logLevel": "info",\r\n      "logRetention": "90d"\r\n    },\r\n    "networking": {\r\n      "enforceHTTPS": true,\r\n      "tlsVersion": "1.3",\r\n      "certificateValidation": true,\r\n      "timeout": 30000\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"environment-specific-security",children:(0,i.jsx)(n.strong,{children:"Environment-Specific Security"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Development environment\r\nconst devSecurityConfig = {\r\n  authentication: { required: false },\r\n  plugins: { signatureVerification: false },\r\n  logging: { logLevel: 'debug' }\r\n};\r\n\r\n// Staging environment\r\nconst stagingSecurityConfig = {\r\n  authentication: { required: true },\r\n  plugins: { signatureVerification: true },\r\n  logging: { logLevel: 'info' }\r\n};\r\n\r\n// Production environment\r\nconst prodSecurityConfig = {\r\n  authentication: { required: true, mfa: true },\r\n  plugins: { \r\n    signatureVerification: true,\r\n    trustedPublishersOnly: true,\r\n    sandboxing: true\r\n  },\r\n  logging: { \r\n    logLevel: 'warn',\r\n    auditTrail: true,\r\n    siemIntegration: true\r\n  },\r\n  encryption: {\r\n    dataAtRest: true,\r\n    dataInTransit: true,\r\n    keyRotationInterval: '7d'\r\n  }\r\n};\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"-incident-response",children:["\ud83d\udea8 ",(0,i.jsx)(n.strong,{children:"Incident Response"})]}),"\n",(0,i.jsx)(n.h3,{id:"security-incident-handling",children:(0,i.jsx)(n.strong,{children:"Security Incident Handling"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Automated incident response\r\nclass IncidentResponse {\r\n  constructor(options = {}) {\r\n    this.alertThresholds = options.alertThresholds || {\r\n      failedLogins: 5,\r\n      suspiciousQueries: 10,\r\n      pluginFailures: 3\r\n    };\r\n    this.responseActions = options.responseActions || {};\r\n  }\r\n\r\n  handleSecurityIncident(incident) {\r\n    const { type, severity, details } = incident;\r\n    \r\n    // Log incident\r\n    this.logIncident(incident);\r\n    \r\n    // Execute response actions\r\n    switch (type) {\r\n      case 'authentication_failure':\r\n        if (details.attempts >= this.alertThresholds.failedLogins) {\r\n          this.blockIP(details.ip);\r\n          this.notifyAdmins(incident);\r\n        }\r\n        break;\r\n        \r\n      case 'suspicious_query':\r\n        this.quarantineQuery(details.query);\r\n        this.alertSecurityTeam(incident);\r\n        break;\r\n        \r\n      case 'plugin_compromise':\r\n        this.disablePlugin(details.pluginId);\r\n        this.initiateForensics(incident);\r\n        break;\r\n        \r\n      case 'data_breach':\r\n        this.emergencyShutdown();\r\n        this.notifyStakeholders(incident);\r\n        break;\r\n    }\r\n  }\r\n\r\n  blockIP(ip) {\r\n    // Add IP to blocklist\r\n    console.log(`Blocking IP: ${ip}`);\r\n    // Implementation depends on your infrastructure\r\n  }\r\n\r\n  emergencyShutdown() {\r\n    console.log('Initiating emergency shutdown');\r\n    process.exit(1);\r\n  }\r\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"-security-checklist",children:["\u2705 ",(0,i.jsx)(n.strong,{children:"Security Checklist"})]}),"\n",(0,i.jsx)(n.h3,{id:"deployment-security",children:(0,i.jsx)(n.strong,{children:"Deployment Security"})}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","API keys stored securely (environment variables/secrets manager)"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","HTTPS enforced for all communications"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Input validation and sanitization implemented"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Output filtering for sensitive data"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Plugin sandboxing enabled"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Authentication and authorization configured"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Audit logging enabled"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Anomaly detection active"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Incident response plan in place"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Regular security updates scheduled"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"operational-security",children:(0,i.jsx)(n.strong,{children:"Operational Security"})}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Regular key rotation implemented"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Security monitoring dashboard configured"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Backup and recovery procedures tested"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Penetration testing completed"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Security training for team members"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Compliance requirements met"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Third-party security assessments conducted"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"-security-support",children:["\ud83d\udcde ",(0,i.jsx)(n.strong,{children:"Security Support"})]}),"\n",(0,i.jsx)(n.h3,{id:"reporting-security-issues",children:(0,i.jsx)(n.strong,{children:"Reporting Security Issues"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Security Email"}),": ",(0,i.jsx)(n.a,{href:"mailto:security@devilsdev.com",children:"security@devilsdev.com"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"PGP Key"}),": Available at ",(0,i.jsx)(n.a,{href:"https://devilsdev.com/security/pgp",children:"https://devilsdev.com/security/pgp"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Bug Bounty"}),": ",(0,i.jsx)(n.a,{href:"https://devilsdev.com/security/bounty",children:"https://devilsdev.com/security/bounty"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"security-resources",children:(0,i.jsx)(n.strong,{children:"Security Resources"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Security Documentation"}),": ",(0,i.jsx)(n.a,{href:"https://docs.rag-pipeline-utils.dev/security",children:"Complete security docs"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Security Advisories"}),": ",(0,i.jsx)(n.a,{href:"https://github.com/DevilsDev/rag-pipeline-utils/security/advisories",children:"GitHub Security Advisories"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Compliance Guides"}),": ",(0,i.jsx)(n.a,{href:"https://docs.rag-pipeline-utils.dev/compliance",children:"SOC2, GDPR, HIPAA compliance"})]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"This security guide provides comprehensive protection strategies for @DevilsDev/rag-pipeline-utils deployments. For additional security concerns, consult our security team or review the latest security advisories."})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>a});var t=r(6540);const i={},s=t.createContext(i);function o(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);