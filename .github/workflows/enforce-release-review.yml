name: ðŸ›¡ Release Review Passed
'on':
  push:
    tags:
      - v*.*.*
  workflow_dispatch: null
permissions:
  contents: read
  pull-requests: write
jobs:
  review:
    name: ðŸ“ Release Review Check
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ“¥ Checkout repo
        uses: actions/checkout@v4
      - name: ðŸ” Scan for changelog or blog edits
        id: check
        run: |
          git fetch origin main --depth=1
          CHANGED_FILES=$(git diff --name-only origin/main...HEAD || true)

          echo "Changed files:"
          echo "$CHANGED_FILES"

          if echo "$CHANGED_FILES" | grep -qE 'CHANGELOG\.md|docs-site/blog/'; then
            echo "âœ… Changelog or blog post updated."
            echo "result=pass" >> "$GITHUB_OUTPUT"
          else
            echo "âŒ No changelog or blog edits found."
            echo "result=fail" >> "$GITHUB_OUTPUT"
          fi
      - name: ðŸš« Fail if missing changelog or blog
        if: steps.check.outputs.result == 'fail'
        run: |
          echo "Missing required changelog or blog post for release."
          exit 1
concurrency:
  concurrency:
    group: ${{ github.workflow }}-${{ github.ref }}
    cancel-in-progress: true
