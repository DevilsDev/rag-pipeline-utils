name: ðŸ›¡ Release Review Passed (Security Hardened)
"on":
  push:
    tags:
      - v*.*.*
  workflow_dispatch: null
permissions:
  contents: read
  actions: read
jobs:
  review:
    name: ðŸ“ Release Review Check
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ“¥ Checkout repo
        uses: actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332
      - name: ðŸ” Scan for changelog or blog edits
        id: check
        run: |
          set -e
          set -o pipefail
          git fetch origin main --depth=1
          CHANGED_FILES=$(git diff --name-only origin/main...HEAD || true)

          echo "Changed files:"
          echo "$CHANGED_FILES"

          if echo "$CHANGED_FILES" | grep -qE 'CHANGELOG\.md|docs-site/blog/'; then
            echo "âœ… Changelog or blog post updated."
            echo "result=pass" >> ""$GITHUB_OUTPUT""
          else
            echo "âŒ No changelog or blog edits found."
            echo "result=fail" >> ""$GITHUB_OUTPUT""
          fi
        shell: bash
      - name: ðŸš« Fail if missing changelog or blog
        if: steps.check.outputs.result == 'fail'
        run: |
          set -e
          set -o pipefail
          echo "Missing required changelog or blog post for release."
          exit 1
        shell: bash
    timeout-minutes: 30
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true
